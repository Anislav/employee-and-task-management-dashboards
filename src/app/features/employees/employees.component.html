<div class="pdf-button">
  <button kendoButton icon="file-pdf" (click)="pdfExporter.saveAs('employees.pdf')">
    Export to PDF
  </button>
</div>

<kendo-pdf-export #pdfExporter margin="1cm">
  <kendo-treelist
    [kendoTreeListFlatBinding]="employeeService.employees"
    parentIdField="managerId"
    idField="id"

    etmdTreeListDraggable
    (dragStart)="onEmployeeDragStarted($event)"
    (dragEnd)="onEmployeeDragEnded($event)"

    [height]="300"
  >
    <ng-template kendoTreeListToolbarTemplate>
      <button kendoTreeListAddCommand type="button">Add new</button>
    </ng-template>

    <kendo-treelist-column field="id" title="ID" [width]="80">
    </kendo-treelist-column>

    <kendo-treelist-column field="name" title="Name" [expandable]="true">
    </kendo-treelist-column>

    <kendo-treelist-column field="title" title="Title"> </kendo-treelist-column>

    <kendo-treelist-column field="phone" title="Phone"> </kendo-treelist-column>

    <kendo-treelist-column
      field="hireDate"
      title="Hire date"
      [format]="{ date: 'short' }"
    >
    </kendo-treelist-column>
  </kendo-treelist>

  <br />

  <kendo-grid
    [data]="drigData"

    [pageSize]="state.take"
    [skip]="state.skip"
    [sort]="state.sort"
    [pageable]="true"

    [filterable]="true"
    [filter]="state.filter"
    (dataStateChange)="onDataStateChanged($event)"

    [selectable]="selectableSettings"
    kendoGridSelectBy="id"
    [(selectedKeys)]="gridSelection"

    etmdGridDroppable
    (dropAt)="onEmployeeDroppedAt($event)"

    [height]="400"
  >
    <ng-template kendoGridToolbarTemplate>
      <button type="button" icon="file-excel" kendoGridExcelCommand>
        Export to Excel
      </button>
    </ng-template>
    <kendo-grid-excel
      fileName="employees.xlsx"
      [fetchData]="exportToExcel"
    ></kendo-grid-excel>

    <kendo-grid-column
      field="id"
      title="ID"
      [width]="80"
      [filterable]="false"
    ></kendo-grid-column>
    <kendo-grid-column
      field="name"
      title="Name"
      [filterable]="false"
    ></kendo-grid-column>
    <kendo-grid-column
      field="title"
      title="Title"
      [filterable]="false"
    ></kendo-grid-column>
    <kendo-grid-column
      field="phone"
      title="Phone"
      [filterable]="false"
    ></kendo-grid-column>
    <kendo-grid-column
      field="hireDate"
      title="Hire date"
      [format]="{ date: 'short' }"
      [filterable]="true"
    >
      >
      <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
        <etmd-date-range-filter-cell field="column.field" [filter]="filter">
        </etmd-date-range-filter-cell>
      </ng-template>
    </kendo-grid-column>
  </kendo-grid>
</kendo-pdf-export>
